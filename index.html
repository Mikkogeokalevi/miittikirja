<!DOCTYPE html>
<html lang="fi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S√§hk√∂inen Miittikirja</title>
    <style>
        body { background-color: #1e1e1e; color: #ffffff; font-family: sans-serif; margin: 0; padding: 20px; text-align: center; }
        h1, h2, h3 { color: #4caf50; margin-bottom: 15px; }
        .view-section { display: none; max-width: 600px; margin: 0 auto; }
        
        /* Kortit */
        .card { background: #333; padding: 15px; margin-bottom: 10px; border-radius: 8px; text-align: left; border: 1px solid #444; position: relative; }
        .category-header { text-align: left; color: #aaa; text-transform: uppercase; font-size: 0.9em; margin-top: 30px; border-bottom: 1px solid #444; padding-bottom: 5px; }
        
        /* Lomakkeet */
        input, select { width: 100%; padding: 10px; margin-bottom: 10px; background: #2c2c2c; border: 1px solid #555; color: white; border-radius: 4px; box-sizing: border-box; }
        
        /* Napit */
        .btn { padding: 10px 20px; cursor: pointer; border: none; border-radius: 4px; font-size: 16px; font-weight: bold; margin: 5px 0; width: 100%; }
        .btn-blue { background-color: #2196f3; color: white; }
        .btn-green { background-color: #4caf50; color: white; }
        .btn-red { background-color: #f44336; color: white; }
        .btn-gray { background-color: #555; color: white; }
        .btn-small { width: auto; padding: 5px 10px; font-size: 14px; margin-right: 5px; }
        .back-btn { background: none; border: none; color: #888; cursor: pointer; float: left; font-size: 14px; margin-bottom: 10px; }

        /* Miittisivu */
        .event-meta { font-size: 0.9em; color: #ccc; margin-bottom: 20px; line-height: 1.6; border-left: 3px solid #4caf50; padding-left: 10px; }
        .event-meta span { display: block; }
        
        .log-list { max-height: 50vh; overflow-y: auto; text-align: left; margin-top: 20px; background: #252525; padding: 10px; border-radius: 8px; }
        .log-item { border-bottom: 1px solid #444; padding: 8px 0; display: flex; justify-content: space-between; align-items: flex-start; }
        .log-actions { min-width: 60px; text-align: right; }
        
        /* MODAL (Muokkausikkuna) */
        .modal { display: none; position: fixed; z-index: 100; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.8); }
        .modal-content { background-color: #333; margin: 15% auto; padding: 20px; border: 1px solid #888; width: 90%; max-width: 500px; border-radius: 8px; text-align: left; }
    </style>
</head>
<body>

    <div id="login-view" class="view-section" style="display:flex; flex-direction:column; align-items:center;">
        <h1>Miittikirja Admin</h1>
        <button id="btn-login" class="btn btn-blue">Kirjaudu Googlella</button>
    </div>

    <div id="admin-view" class="view-section">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom: 20px;">
            <h2 style="margin:0;">Omat Tapahtumat</h2>
            <button id="btn-logout" class="btn btn-red btn-small">Ulos</button>
        </div>
        
        <div class="card">
            <h3 style="margin-top:0;">Lis√§√§ uusi</h3>
            <label style="font-size:0.8em; color:#aaa;">Tyyppi</label>
            <select id="new-type">
                <option value="miitti">üìç Miitti</option>
                <option value="cito">üóëÔ∏è CITO</option>
                <option value="cce">üéâ Yhteis√∂juhla (CCE)</option>
            </select>
            <input type="text" id="new-gc" placeholder="GC-koodi">
            <input type="text" id="new-name" placeholder="Nimi">
            <div style="display:flex; gap:10px;">
                <input type="date" id="new-date">
                <input type="text" id="new-time" placeholder="Kello (06:00-06:30)">
            </div>
            <input type="text" id="new-coords" placeholder="Koordinaatit">
            <input type="text" id="new-loc" placeholder="Paikka">
            <button id="btn-add-event" class="btn btn-green">Tallenna</button>
        </div>

        <div class="category-header">üéâ Yhteis√∂juhlat (CCE)</div>
        <div id="list-cce"></div>

        <div class="category-header">üóëÔ∏è CITO Tapahtumat</div>
        <div id="list-cito"></div>

        <div class="category-header">üìç Miitit</div>
        <div id="list-miitti"></div>
    </div>

    <div id="guestbook-view" class="view-section">
        <button onclick="showAdminView()" class="back-btn">< Takaisin listaan</button>
        <div style="clear:both;"></div>
        
        <h1 id="gb-event-name">Miitin Nimi</h1>
        
        <div class="event-meta">
            <span id="gb-time">üïì Aika</span>
            <span id="gb-date">üìÖ Pvm</span>
            <span id="gb-gc">üÜî GC-koodi</span>
            <span id="gb-coords">üìç Koordinaatit</span>
            <span id="gb-loc">üè† Paikka</span>
        </div>
        
        <div class="card" style="border: 2px dashed #4caf50;">
            <h3 style="text-align:center;">‚úçÔ∏è Lis√§√§ osallistuja</h3>
            <input type="text" id="log-nickname" placeholder="Nimimerkki" style="font-size: 1.2em;">
            <input type="text" id="log-from" placeholder="Paikkakunta">
            <input type="text" id="log-message" placeholder="Terveiset (vapaaehtoinen)">
            <button id="btn-sign-log" class="btn btn-green">Tallenna</button>
        </div>

        <div style="display:flex; justify-content:space-between; align-items:center; margin-top:20px;">
            <h3>Osallistujat</h3>
            <span style="background:#4caf50; padding:2px 8px; border-radius:10px; font-size:0.9em;" id="attendee-count">0</span>
        </div>
        
        <div id="attendee-list" class="log-list"></div>
    </div>

    <div id="edit-modal" class="modal">
        <div class="modal-content">
            <h3>Muokkaa tapahtumaa</h3>
            <input type="hidden" id="edit-key">
            <label>Tyyppi</label>
            <select id="edit-type">
                <option value="miitti">Miitti</option>
                <option value="cito">CITO</option>
                <option value="cce">Yhteis√∂juhla</option>
            </select>
            <label>GC-Koodi</label><input type="text" id="edit-gc">
            <label>Nimi</label><input type="text" id="edit-name">
            <label>Pvm</label><input type="date" id="edit-date">
            <label>Aika</label><input type="text" id="edit-time">
            <label>Koordinaatit</label><input type="text" id="edit-coords">
            <label>Paikka</label><input type="text" id="edit-loc">
            
            <div style="display:flex; gap:10px; margin-top:10px;">
                <button id="btn-save-edit" class="btn btn-green">Tallenna Muutokset</button>
                <button onclick="closeModal()" class="btn btn-gray">Peruuta</button>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    <script src="app.js"></script>
</body>
</html>
